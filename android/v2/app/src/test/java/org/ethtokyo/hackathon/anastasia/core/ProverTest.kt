package org.ethtokyo.hackathon.anastasia.core

import android.content.Context
import io.mockk.every
import io.mockk.mockk
import io.mockk.mockkStatic
import io.mockk.unmockkStatic
import org.junit.Test
import org.junit.Before
import org.junit.After
import java.io.ByteArrayInputStream
import java.security.cert.Certificate
import java.security.cert.CertificateFactory
import java.util.Base64
import kotlin.test.assertNotNull
import kotlin.test.assertTrue
import kotlin.test.assertEquals
import uniffi.mopro.ProofResult

class ProverTest {

    private lateinit var mockContext: Context

    @Before
    fun setUp() {
        mockContext = mockk<Context>(relaxed = true)

        // selectAppropriateCircuit関数をスタティックにモック
        mockkStatic("org.ethtokyo.hackathon.anastasia.core.CircuitSelectorKt")
        every { selectAppropriateCircuit(any(), any()) } returns Circuit(
            vk = "/mock/path/circuit.vk",
            circuit = "/mock/path/circuit.json",
            srs = "/mock/path/common.srs"
        )

        // prove関数もモック
        mockkStatic("uniffi.mopro.MoproKt")
        val mockProofResult = mockk<uniffi.mopro.ProofResult>(relaxed = true)
        every { uniffi.mopro.prove(any(), any(), any(), any(), any(), any(), any()) } returns mockProofResult
    }

    @After
    fun tearDown() {
        unmockkStatic("org.ethtokyo.hackathon.anastasia.core.CircuitSelectorKt")
        unmockkStatic("uniffi.mopro.MoproKt")
    }

    @Test
    fun testProveParentChildRel() {
        // テスト用証明書データ
        val childCertPem = """
            -----BEGIN CERTIFICATE-----
            MIIB3zCCAYSgAwIBAgIQQvetP46myG9iTwJUbolpXTAKBggqhkjOPQQDAjApMRMwEQYDVQQKEwpHb29nbGUgTExDMRIwEAYDVQQDEwlEcm9pZCBDQTMwHhcNMjUwODE2MDkzMzQwWhcNMjUwOTE1MDQwNDMyWjA5MSkwJwYDVQQDEyA0MmY3YWQzZjhlYTZjODZmNjI0ZjAyNTQ2ZTg5Njk1ZDEMMAoGA1UEChMDVEVFMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEH88NDZL830j8Hphr+uyr6HE3Hoz1ubD94LfRWTW3wVGzkvxWzr6Dj58smDrX3vEzlOeBOfLW4rtAiT19168u5aN+MHwwHQYDVR0OBBYEFAU2N5IqenydpSl8wZI3gK1UH4dvMB8GA1UdIwQYMBaAFKKRHWQmS9469q7vyp2oKlCYLYZeMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgIEMBkGCisGAQQB1nkCAR4EC6IBEANmR29vZ2xlMAoGCCqGSM49BAMCA0kAMEYCIQC14FLeR/NmDYThQtgYVgLE3b6xHJ6HNcPC2j4w0i/8xAIhAPxsMYGIPpN2OQwKGdHFzp/MFBmJnj4ce5k7IqRx+39z
            -----END CERTIFICATE-----
        """.trimIndent()

        val parentCertPem = """
            -----BEGIN CERTIFICATE-----
            MIIB1jCCAV2gAwIBAgIUAJ7VjHfw/KwtOc0aHXL0VbRqe8UwCgYIKoZIzj0EAwMwKTETMBEGA1UEChMKR29vZ2xlIExMQzESMBAGA1UEAxMJRHJvaWQgQ0EyMB4XDTI1MDgxNzIyMzEwOFoXDTI1MTAyNjIyMzEwN1owKTETMBEGA1UEChMKR29vZ2xlIExMQzESMBAGA1UEAxMJRHJvaWQgQ0EzMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4hxkUuFiNE9dtMSz+zZkWkersfdcZSWR1dNLwumpWHlSfVzlwKEIGin3ZWPMjAKhmC6t5AEJQFTTo1cxbqYQnqNjMGEwDgYDVR0PAQH/BAQDAgIEMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFKKRHWQmS9469q7vyp2oKlCYLYZeMB8GA1UdIwQYMBaAFLv4Nq2Jrmzi5Z6U8NWy19J65HxBMAoGCCqGSM49BAMDA2cAMGQCME5dRrUSl9ER4aYqgYlMAOj+55hYvLGykR57DAQBoqC1B1X8DGZNzXoc+nd4Bza5AwIwFiOA9UI0rWbvBcnv6g5u4dAxt3faprvHRs/6CDNOMVWhsGNs59Ln1yfX6p9aBbq+
            -----END CERTIFICATE-----
        """.trimIndent()

        // PEM形式からCertificateオブジェクトを生成
        val childCert = parsePemCertificate(childCertPem)
        val parentCert = parsePemCertificate(parentCertPem)

        // テスト用パラメータ
        val caPrevCmt = "0ede28f511104f08069e07986707873be5cbba917f02f02407ad1fdd6838679b"
        val caPrevCmtR = "deadbeef"

        // proveParentChildRel関数をテスト実行
        try {
            val result = proveParentChildRel(mockContext, childCert, parentCert, caPrevCmt, caPrevCmtR)

            // 結果が返されることを確認
            assertNotNull(result, "ProofResult should not be null")

            println("テスト成功: ProofResultが正常に返されました")
            println("Result: $result")

        } catch (e: Exception) {
            // エラーの詳細を表示
            println("テスト中にエラーが発生しました: ${e.message}")
            e.printStackTrace()
            throw e
        }
    }

    @Test
    fun testCertificateDataExtraction() {
        // 証明書データの抽出機能をテスト
        val childCertPem = """
            -----BEGIN CERTIFICATE-----
            MIIB3zCCAYSgAwIBAgIQQvetP46myG9iTwJUbolpXTAKBggqhkjOPQQDAjApMRMwEQYDVQQKEwpHb29nbGUgTExDMRIwEAYDVQQDEwlEcm9pZCBDQTMwHhcNMjUwODE2MDkzMzQwWhcNMjUwOTE1MDQwNDMyWjA5MSkwJwYDVQQDEyA0MmY3YWQzZjhlYTZjODZmNjI0ZjAyNTQ2ZTg5Njk1ZDEMMAoGA1UEChMDVEVFMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEH88NDZL830j8Hphr+uyr6HE3Hoz1ubD94LfRWTW3wVGzkvxWzr6Dj58smDrX3vEzlOeBOfLW4rtAiT19168u5aN+MHwwHQYDVR0OBBYEFAU2N5IqenydpSl8wZI3gK1UH4dvMB8GA1UdIwQYMBaAFKKRHWQmS9469q7vyp2oKlCYLYZeMA8GA1UdEwEB/wQFMAMBAf8wDgYDVR0PAQH/BAQDAgIEMBkGCisGAQQB1nkCAR4EC6IBEANmR29vZ2xlMAoGCCqGSM49BAMCA0kAMEYCIQC14FLeR/NmDYThQtgYVgLE3b6xHJ6HNcPC2j4w0i/8xAIhAPxsMYGIPpN2OQwKGdHFzp/MFBmJnj4ce5k7IqRx+39z
            -----END CERTIFICATE-----
        """.trimIndent()

        val parentCertPem = """
            -----BEGIN CERTIFICATE-----
            MIIB1jCCAV2gAwIBAgIUAJ7VjHfw/KwtOc0aHXL0VbRqe8UwCgYIKoZIzj0EAwMwKTETMBEGA1UEChMKR29vZ2xlIExMQzESMBAGA1UEAxMJRHJvaWQgQ0EyMB4XDTI1MDgxNzIyMzEwOFoXDTI1MTAyNjIyMzEwN1owKTETMBEGA1UEChMKR29vZ2xlIExMQzESMBAGA1UEAxMJRHJvaWQgQ0EzMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4hxkUuFiNE9dtMSz+zZkWkersfdcZSWR1dNLwumpWHlSfVzlwKEIGin3ZWPMjAKhmC6t5AEJQFTTo1cxbqYQnqNjMGEwDgYDVR0PAQH/BAQDAgIEMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFKKRHWQmS9469q7vyp2oKlCYLYZeMB8GA1UdIwQYMBaAFLv4Nq2Jrmzi5Z6U8NWy19J65HxBMAoGCCqGSM49BAMDA2cAMGQCME5dRrUSl9ER4aYqgYlMAOj+55hYvLGykR57DAQBoqC1B1X8DGZNzXoc+nd4Bza5AwIwFiOA9UI0rWbvBcnv6g5u4dAxt3faprvHRs/6CDNOMVWhsGNs59Ln1yfX6p9aBbq+
            -----END CERTIFICATE-----
        """.trimIndent()

        val childCert = parsePemCertificate(childCertPem)
        val parentCert = parsePemCertificate(parentCertPem)

        // 各種データ抽出機能をテスト
        try {
            // DERエンコードデータの取得をテスト
            val derData = parentCert.encoded
            assertNotNull(derData, "DER encoded data should not be null")
            println("Parent certificate DER data length: ${derData.size} bytes")

            // 回路選択機能をテスト
            val circuit = selectAppropriateCircuit(mockContext, childCert)
            assertNotNull(circuit, "Selected circuit should not be null")
            println("Selected circuit: $circuit")

            println("証明書データ抽出テストが成功しました")

        } catch (e: Exception) {
            println("証明書データ抽出テスト中にエラーが発生しました: ${e.message}")
            e.printStackTrace()
            throw e
        }
    }

    @Test
    fun testConvertProofForInfura() {
        // this.proofの構造: public inputs + proof
        val dummyProof = "000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000e90000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000013000000000000000000000000000000000000000000000000000000000000001f00000000000000000000000000000000000000000000000000000000000000160a912b4a440ccfee5b14a79b5c741ef9fa6cf5fa3d7d7760f660d3f7a549e24127e9f91678b532f50dc71e9d82ba543f479a73a6b0f263113525db9715fd0eea0000000000000000000000000000000000000000000000042ab5d6d1986846cf00000000000000000000000000000000000000000000000b75c020998797da780000000000000000000000000000000000000000000000005a107acb64952eca000000000000000000000000000000000000000000000000000031e97a575e9d00000000000000000000000000000000000000000000000b5666547acf8bd5a400000000000000000000000000000000000000000000000c410db10a01750aeb00000000000000000000000000000000000000000000000d722669117f9758a4000000000000000000000000000000000000000000000000000178cbf4206471000000000000000000000000000000000000000000000000e91b8a11e7842c38000000000000000000000000000000000000000000000007fd51009034b3357f000000000000000000000000000000000000000000000009889939f81e9c74020000000000000000000000000000000000000000000000000000f94656a2ca48000000000000000000000000000000000000000000000006fb128b46c1ddb67f0000000000000000000000000000000000000000000000093fe27776f50224bd000000000000000000000000000000000000000000000004a0c80c0da527a0810000000000000000000000000000000000000000000000000001b52c2020d746000000000000000000000000000000535b90d21716c788151f621bf4f9923ecc0000000000000000000000000000000000118d577051fc9469a61bc6501aa8bc0000000000000000000000000000000f1ccbf679e30fca7b22446caa5a6f245e00000000000000000000000000000000001e72f568f42de262f03c86f16b97a20000000000000000000000000000009e1d6992fd761fc2387b3a9f864a70a2a400000000000000000000000000000000000a2ff3cb39a2929c07e43d174d9dd3000000000000000000000000000000125fa778ceca6e1760297114375a18efa300000000000000000000000000000000002e63146daab20e90f4ba5ccf7a90a4000000000000000000000000000000465c63cd51c0550b6ba411647372992ff7000000000000000000000000000000000002a0bd000283cc99a4a6f00402e782000000000000000000000000000000fe261248ba023453da38b68f8465f0d17300000000000000000000000000000000001f6978769fb835c686c9339ef4c36c00000000000000000000000000000082e61aeec67cf9310537dbc737480ac35a000000000000000000000000000000000009b84e3eb682d48c51a239811525c0000000000000000000000000000000b55bff66de5fbddd4b56ae7d2663a62997000000000000000000000000000000000007e3adef700757856dfef04869713a0000000000000000000000000000003340755cfbeb85271f09e0a52280889fa5000000000000000000000000000000000001e415f74d0282de936d468e44c2ab000000000000000000000000000000f4bbe6df3d66cee2689e84776a22c0ff3f00000000000000000000000000000000002d952a701eb74ebbcdd63cf401f5f9000000000000000000000000000000e122be665bc0a38d8cd5e469166e41f4a700000000000000000000000000000000000a2ae2e6fd6dbccdb4991acc89bf9a000000000000000000000000000000bcc427d80ed23d5ee12ead7e7253c0d51600000000000000000000000000000000001490491b2c89736d1366d5298ce55400000000000000000000000000000033bb5bcd8f4193bf85bd4b3a8e2044e1fc000000000000000000000000000000000029905cefca3f940d1b34de3bb5e256000000000000000000000000000000b38530e5c1cfc6e918f982fd9eab4190f2000000000000000000000000000000000011a81b31e9fb4f082b6916ef5d08c7000000000000000000000000000000cfd8f427fa71a04c53ac5392ffdf7128f4000000000000000000000000000000000018818836a0813fcf3c7bd2e185fb00000000000000000000000000000000a3d5947cda9b66aa0eaa31dd659e6509130000000000000000000000000000000000295e52f1cb090b2a452a840b4c91c6000000000000000000000000000000ee89f0e436641b37600397aa77c106e65800000000000000000000000000000000000260eb0dc0aae534a31a6c69e39b82000000000000000000000000000000223e3167d14baa9284e893b2dbfdfd8e4b00000000000000000000000000000000001614ca0faf176e0030319b26438b94100ccaa8be715f2e7bdcc81ee7fc4672c062d73caa1eb864902403725ba46b3506db3d41735e2fc4e555c171e68a80ab01e834b636992f5bede8a29ed1cb9cc91d8ad47a74715eca398d183b1933e4ccbfc03e9b0d3c8c86ce0a1fe5790105a41b91cc677839ac5e5f51d82c9a666b7f1383e47423192c84e08bc7d1408a0c42181365d6aa8b06d0e6bbc3ac32199640f43f58137bed7837267756ebfc9e16bd09f79c3df2dd76198e3ea6de087b935b66fd76db744cb98a056a59c93541211f10fddcb43c9bd7c04f623f8a3d02c1c699d60fce7ec7d33675bf174cbc6cf3a620fcbee3958db267f2fa5fec0b40c902d73ed2db323d2b1d54a800afa01913ab131af3707c6e028f2284517528ee301254680c0e77b1d1953944186aa273fb861f833535aff6e8c64e3c34377e9bd23f3378bc36e1b0ea0a7d0b0b9281d3cfa3070f6598153da15265c15a97ebc39e3945a041b2c52c851e0635caa4da5f43972caaef307f08574d747457b5a2800183b0fcef197dc75b59227c13011b6f53a12ac7bfd20b76746486de3e6c0301de943b6102cf802463f1e4dc24e8d5811f8e2b597ae6aa5937c3c8b3f728da896b2d828c6b6a3ca5522903020a3a0e2706fe2ccaa94ad296c57e15400177b4eef0ae1efb71e0a83a8b9ea57f523d4ce162d418ace42780fa4baa154fafab31497ba328c44af597ea2f1db46e2a799db0e6c50ca126fb1238d970d93157aa67525d8e2988640d61e2ca78ba62b102ca6d60862fa45a78b556ae158fb7096c010c1e3c4dc22a1ed8698aaf34fb0b73b26165b71df7f4f95eb5d242ddbe6dc473807a7bcf1be6073fc04d3ccdfdb8e1d332887426fc965378537354290cd41d5d8ed29439239222d8ad15a52170a21c2c0efe840549fc35dd38159d2691d528536f0e0b2b18b5ea07cf131a1d6df23fe435df8b0f91bc7f8c8c4ef41ee30df5e8d2ed9826d6b61d1229b70f06540aebacc28aa71fd1346e08cbad5d2663345c55843a57910c8f2aa87e772e547319ac07cf5d370f9dccb0a5a5ba780c0408553d82bfc30d17fb341fda6a60b5ff2dbff4298df60ddbba5646d195db9e164be32b1c72940aea8eb1c66268c6ab89d7bc600544c61eddc61cae5ab60af8d667db53ff8d54f50ee65809087e8da2d8dc5d615e6e9029e2b70c836b6b9fc1b6f638be595079895977f4e24bf6c73d7af30075efc6bb2e62555b15024f9d01471f649f53ad6e43371716523bd90c6495165402b9a7bc2186f7d9864c9e66c71abdc0e5352dc061d1804e91b61b2f2afe62a75f6f06d92559b739ff7a776bf98d3581ecc8bf27b7e62f8fe3d7390f081e745260565a0b0be25e7b5d116dc78beaec1d919a31f1df14e1ec4f5c08236e5e9f6bd83f815b226312ea0ef6f9fca6141cac2d2bd47ebea0091afdde60134b316dc13816538b1bc1a9c9e9a21d26051200e6af4ffd05a15b85afdc9d0e580b5dd9fc1f404d3b0e6884fa01cb700cdc45c2b0b2950415e851d8ce6de9c5a779b74d2bec56fa300395d13ae95fea3d20c81921408ec102ac119e04e0a3b21fe8193b62535a44c816dcd1dd11c4afb1d699d4a321f94abc30f60294dfd54490e483b4240d6c8d2d228576c2ebc6aaa6770e53782f822be1b03081afbe5d4bb1792d36b0233824bf10f9c8b65e3aa068611d209ec15d42ea213eed185ea284fa4ea2bc6e179dc95b197cac92efe7193cc746384194deb43d714c90f1bcb451ded2f0bd7d109dffdc068299dfcaea58449ace44fc7a0c6f7951181351432190f12a3f9524a03bc70b2354d83154c54e77ee9b10699037f77d73cc5006c87dc0ea449d08eeee6232881f3a9f004ac363b421c47ba38db7a3748494187b3e397a4e47bc10589c4ea87618bdbec40df9eb7691ff011a8cf4a53a4221a76d766a4754f763e724dd2d993a2cc6b27496a02836246c6590a258b3ef8617f2cdb6d4c6a6e19e1a2ea3d7381101f18f65988b640a01dcae18feab398326071a1b0fbdc4b1ccddbd1a3ca873b303daa323bc3535c5c422d1647f3553b285dc1a1881ce33431aeb9c9918bf1cce1dd992a6c264f7f157c1e8d3285f36fb0a2aa8b3e543533cff86da78a7972325060ba6826b4707f02efe11166499dbc1bdc4d4d4cb2f29f0bb62dceec2014fcb06f0b8d193eb4cf1b3fa7351f7718f2695b98af825f7f077036c7d71bdd9643d2063002ff00f24fb094625c48c57a31244244759974837a6eb8eb50c2d9f8332076dae765053e87ec8dabd996da059c627a50369cf25c27e2179ccb9532c36431947e2e4af9b9e9268a72eb54c15ca40fffdf4eb53d9aee4a21fc7df6f30c27c2d3fc5e1cde5eeba3a5c9ebed18b0b642e6a89db8508b6ed1dff409a47ebe2b1060a909975d58d536a9f6816100e8d7629dcacb6ea265d56beb17a11006046c703b27843010f6f14871ffaa8cf907f8582d114806b52d94e5e518a4e3b59ee1a2bccc06145b6d4e2400af247a2698230b5f0bf8a15f8562201674fdee173e05a203badcc3e3a246b851b94725b70802677e98ac798ec98de76c7c562ccf940161ff9ee9383e247f83b82d3428ea5847f8d80fe739adb6a2b0d15ab0ac3142f5503d2bd573f971185c80fddc3622e22795f2e0e69ad3497c55969202d6ddf05ea1b92fb9d577eef985693bc4eb75d810125711ce270aaec9d35b8c960ae0033f7241addfba55350eb876d9a402bcad7591efc47b696be85c20a1b10a0be0357140b1c595d8e4c656d2bc8ae6b44bad01a2b044f67bb33aa89dffc0c2e01a4d2201a9fccc41c7451dc8e7c1705f165bcdea27ff6ab911d04bcba831cde5f860c9227a6142e6deccebad34c700dfc3b4b40de13df3f65ceccf9baf4506c233fbdee1bf9c64e3be35007522df7b7136aceecf3ab03fc8436564eb17a8e82f3705964101b8602dda03c81bb1b1c43001107bc5836063399aa41f1670cf201453973701341e7c48acc0fd756c318b38eef7a8b5b55e6b232c678fa5ac5464e818310f12e5705282b402fc00abeae10b4c60a2bb7004b641d09f9c6ea698097839d1c852c156d09219ee550b6953af7c68e2f0e3c4d60b8b285fcd4746e8afb6a77cfa9104d61b177f61ec354b21405b9e9bfde53a92f64e08e88d48528aae3207ec7bc060d1d31a0f7c72c70080841f6f5bf5b5925a011ef8c11ec0c7334b528f25d5f15e021662c06c3f3451f694223c34d9153e92818a5ab90ca57c9b4e54a6c4d2c0e742d97f2df7b5565ca7bbd6612c4c43e6462fcd84bc5c86635c835ae03ce9e0f89adb43bb6d9518bbc79cf11a1b718a2f814d1d53a5c8b0f5299b576b753dd2a2af5812eeca9a9977abba189feba7a0a4b427f2ea250e31176dab4e339d01b0d4cfe89f1888fe54592268f3ca1ea94c00bfe3517b7aebd2e8fe735efeaf2152cafaa85ee718bf778cfb9257dd6977f19139ca8b56c5b90dae8ad937395cfc41d8f00ea9edc98245d08edae3865d7880e884058fc8a0bfe0b921229760f10f80667033f29fe8b29c13e36ead58c1e3fb380dbe9f7ca04121e47580506bd27e627ae9605f1cd7749fc4be2721501bbc0e5ef0c8b176e7f4abed8a0a707fb02641b5ab5c49346bb18519410f6a30dda9794e210e8c8baa7d1efc3729680749d321931af0ef32b2d2b412b49dd21331782bf20820e35f33ffb6cd9d8d39577d35118bb032f60aa71c2c965355ae604767ab723c31ce84750ba3402e428ce71bdcb22fc42bcd91696233a92b16f51e44cdb6844818c9a83a8ae885cba701302e40f03a48f2fdb49c555ea7d6b834c8dc0c5d89c710917b0c7e163c5ce25319577e702db94e2bdfcec353c6a7f6ba7356115f86e688de0a4b62ad08aa0240bbf3d19288d4b491492206c078b68fef1686a97068004ed88023983a4330dea03ee0d081853c378ce2dba7d8b5338c03e8357e00c12a002bb47f264f3857fbdf2aaadc611acad576bb9586652994e33beb32a96e466e11eb6ff3e49dc383c8db51f0fd80a4f3d20ab14f0661f3baa443f4c77ad3d8507decffc0c75f0ba192e3e918a7e0c17fb0a7d649ede80638695555dad6526bed6333de79eaf7bea13c04892a3d0279510c137bb13f23fb4cd2e00bb1ef508e568493073ce63ee9e6af8d85132021546052f1635e87a7755e48ac4e8960249663013d4768124b6f930eadd3ca33a0310c05a11af553debd430660726c4ea09c95c147eec76047f6b7c641f4380611f02ea1c420f37e18801f0b36d494e1a4ec7574a4fd2efb95f8aeba41166b45c2bd73fc8dbac03e83d289e723cad2258d874ed4454fd97a32afe916b799e1cc90e3c369171e92f44901bc6a4d0b79bc8f05fc07034545db74c3c431e610ab91404d2324e8c127782bea59cf1dab63702d805d71e42447c2bf63541f44450dece29072ed3cc64e15c9a2eb895ee0ca5c036f6bab0aceac6654be22eb55d3dc7bd271e8ff8fe7b6c74579c74b404ef774ae5b71665844a416862b214d93373a0d329f337a4e5c5e73b2d1464f35e3f36a97190d4e6abbd98733cd9c5dc1436554518e1e6e3bf2afdba50058f3aa9edc2e5514a1012afceffbd7c4879ade794b8162a92f6f186a871cddc5f8ab46141b4848528672ae9ed7b975a899b702be05cde14040b295d2624f66eedab1c2bb934f8f69b07205062b646a6cbe1ab94c862da00dd2149d5bb49c34ec5198ae2c5019e1a2d88b577eb72f172075308b0afd2b90854b1302016bfd02d51e21a31aa1d9daa99cebd060eec05f1b9f823aa3e48fd239b519f6f5bc45c2109c85a18b96433e69d7cc4a08fe21de3622b495d2d33250da26bb739862f9d52919cf1bbfd8ff08cc30765e3947f7f6c30e4a96bc2a06b123afeb14de59530e5f6def3b60e4f7c5e537689da9e8356967b948da081179f0e454335274765cba5844b7fb28103fba71aefd272c77a0f9ad7fdb27c32d05702ef82c1b87904ac61dc21f8f553b57a3836f8b8eb689ad149b9a409a42f6f39152f06014ea3182a223db473360aff6f8da8d2cb4930c1d3a08e772e1497fea822223350246834672120108c884d1e7360cb24685c1baf1e7fe05812e15fab7a073d3457dcbcbc9c239b4ba025255ce4027124cc9f07b80fd571d1b267d42e690dd8191eaa9a6a0e4d70f4ec48086e97ccaf93625101cb39cc256bbfd985382a1747ba25ba60301667616e92953721bebfd92f69161f880fc8df47a66121362510e194a24759dbdef4e7893bd158358de7f1e3aa7d4d49871d5f26928eb96717086f1bed8aaac9617379418616a909c289e054ff831ef7a867051a7da5fde8b917c57aa392a57135dec6ce274cebb1f5aa296d096ae3ef5c0a893570b06b945b13237f59690556afcd257a46b1917dad91acdaddc781ff015e510270454988ab2aa5fcfa033b39390de5b2d6c57c707fe1da5315abd0d50acc671ae9d96e8d031b0921f5124449821f716c93a033333cec6f254c2be86f697e1cddb5432cd0b32c122303187cfa08edab3e099ba48ba0ad6a10325f9afa060ed5a7ef351b3fb32a20fab4a9a58cfbdbe62ff217457fc8e3d3dca53b82f1d7298e157c4e1e14cb1559f87c00e1e30ba4d0725cbfde8a1144c91f642b12809bdd29edc9df48c66622880fcdfcd45f11ddd55e2d2a32877bf5f7cf13f5f05576e7a03da61545ca8a195d5bb4af0fd7ac80281dc23648ac8310665babdb1cbedef6cf4f0622f826522b442d26f47ea7b0dd681aebd240d5859721539b5df35ea297fda72aba17670510a290f618986158203b6b5b6d5195601f096e49b2f2acb3968981d7160df50817871a247c3a739747276f2cb1ec5b76a76a35bdaa6f7e9a4544c9fa1487606310bde3e1006947dff7e36247addca9a06f0df6fe5756c3076800167620ef9fe72638b4213b7d666421e4e59be20a09e867ca516c96060f114b58dcecabd1129417a07ea5357980f6b053669672dca3d026215b66e5bca2ba391d610c54ad3e6a05d041989c1ff2d39f4bb48183a02e767b895410bcd78f0814b7359d2b835f04138f9e4b0ea29bef8a59968e80789b2f84ff7dbb5c85fee26230fda313ac2f832f828cdfa43ac57d94e99dbc6aac367bd18ddc9d2ed467fd9252aa305779cf0f1f035bfbe2a9d7b640a4a0b0b7042da01e211126b097b57c3d624a376fee1afc239d839752ff98d2a037d1e0f49c4f6eb54964e2f7ec631a91ac8efa2aedd1f62d3da0c96ec72046671d0e4b033191fde44d1f2ec8180ba50b6c72769ab062f8212ee761d87ca1eaa8d4a21d6383993e36034656de158cc9694a933a44af41b929f7b90b6d991aa64c6ff79c24b4afc5ba5738ddccb711d9714649fbcc8b2f24295d62bbdafbc0e397a923aa8067b76820ab2e830b26b3754f55ed3116da9e5a1042c874743d6419478fabc5d6e3681037a65a1638bd164e5f0f4f91fb97020d15cc17e47540d4fe4c4da8c6375304edb14f654a2b2b713acb7567b337b9a4be24acc6f8bf98003ff58374470f47954b76747ede4a2b4c671ef5dc22186f9da302c5e0da8386f314501504c68914648018d0738cf7818503bb9fb356835867cf0d77284870e400af74a41286b171ba0ec9d86be027afc9e82d30c96c4ca246c13048ba5f7ae8477e65f8f0ffbdbe193261184af4300953e67c1cbafa8885e9c9163ebff3c3c10a669bfb694e38cdfc9bb78e9332a2fd662bfc5efdfe97053b082b4968c500c8a71eb7a3a5d3b10842bb9e3cd3115edc26e348566938a71ca4fb29ef49fb601563eeccd43e371b79dc9762dc7833bc179ea300b5a93207974d1622010224d988132989c72138541b23e81c75764f531dec2861583e367c01496c0ba5b2a2f95393fc98e9a3cabf9941559f68b8be0ffb9cef1563aa59549e6f22301cd2b21123cabf43b2f414540fac777f485f74bc6c110cd102d94b1e9fcdb11b4219442561a16f4ef309d1cbd63f25d2fa86882f17773d6c4ee8c6c974776d24fbedc9a615695995238fa5e91604b0d80556e78f35f91cd20e1aa805915df72cace7cc4ad14411e13ef6ed3e9898ca8853d3f9bbd0fdbb9786eb69082da82a2f32c62fd10ed4d1a086680cbefaebe3c267b5e48dcd055112c462e648a941b92a4aa5c3673ec725e1baa2f33c6666b9fb80ad0b6b299b362863dcbbbe2b793a15f7d0821af702d8de5eb63a1b182ef9d54e60e7ed3dc5c3bebad005952d39850279323eef5c7b5dedf9290fdc5d6c502408fb74a081d0e2987719714468c8ec0b9a9ad7798b6b7b3d20f4fa627e8c2b0792b2ff8842ce1ae17ad84697dbe4852cd818fbc986410a2f09c60a95821aaadd6aaf3d64c347b7bac0eb9f96a939b600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008f39fcf18c31df0941dee4b8007727ffd5fa16d3e4617166db6fb6ffc980c800476e3659143f450a053f31aaaf3eb80a37d234526fcb88bcc19a1760c95a26808cc7da9aac95850610b5e85947e9ce3c1b8061a8dbbce491926eba33e209cac28247d9db2b90ebd02354eb8fe5ed89b66b86d3465123ad6aebb5be7fb1a4e652efe82671b763b16082772b5a29bc6e4e79cd38f7f752e2389ddd307e63d3b070c4dd6d5c0514e343290abba3843300f71b9261f792460d2e2439b90304ca4b529a94bbbc37c4c8a0b26087062380247c774d3d37368fa4079b20f05d83de1261252f7e57b53e8ee13b86b92bd5ec720085d9375cf2259fe656f9152434d6b6501c7737b5e9bfe9265149775436409530307115cc768a9ee243890ac789a9a54209499c1d58bbcf71804dce545f7d2892894d0691c7f3261438d18fbc6ec783c0c993f3c3834212d35b726d467cf115b1277424355bdb19cbf28c61289310ed629842b5440d0f5936a3eddd4dcd962495a0fb617789936f99e36f784b127df1316af88fa7757efbb1350355ce2b767d3fb8021f2d723dd479434252664da8baf257a9c0b90b256692666574c46ab41592d1975b29acbab818bfaa815173ad79c035eea351503bc76c03159f9e45bfe24ffb546285b559ebf57d384bc634c41442a8513608f8e123e238e4e4f93fcd4c54e349b357a3760b36ea2d35e183397c929556e3d8f8bf7edde9c500016ab993a992ac3f7c3c0d3356c9bb38bfd2bc55d202fafa4cd3ecb650295a170a602a95125b09a38d4fc467bdfd402713b08de5d21028598da6279e6125b3232e66ac115a8e44297c50f14f12775ec35728985ff046815048aeaacee2aed6809fea6c2acc9f60fa27fc51bfb15620871cb9e44a121bdb14e012d08e2508a322b6ab1d03706e0353c7a2d5e04767143eecbbe1455145ed73a7700cbcc49d62a1c8bed99dca724f6cc398906e812c3ce5d4c2e56082e104afb97d379fd7d8755a4f93d8f0ac3e02fffdab0c27e2af053a6db46131f1e51fdb8c15d801c28e3bbca842118c9d81fcc8deefb845d324bc6436a13dcb215078737469d1d11bc12c9d775358d26897135cd265fad44eb52d49251e6f8aa1e2731789f93fbff8d0145bcfe1e0c939d3321f38369442e2feaaa2499dfbeec1006cd6cb78c6cc690935a124a612c1357a08b276b01dc01b4d4ba73d7415a0a0eb39c31d20c49384f05fcb7b7dfcde3a038daafb36ce0d9ea1168f6a67087ef2452ff7513359abf0b91b98d10e9392be14e5d462d2af4b6818faa419d98c7ef238387c9c87d396a93cc65d09c8ca7a6db7ee5cd0cb199924feec6cbc20f53a42d82df904973f69603f0308f82391b602dc0db40befeb4d3c2c1f8aea52069cb0ee13c71f2148b4e11d53f22eb0faa5c8ef0ce9b8cd658db50029af685477cc92a0a899033ba6745c3129ab14e9f66ea0727dcbdff76b2c29ac26798af03ab0e20dce5252771b2e418e30da37670b4c49fb1485d61c325a0c6d810465df572cc1d64912db12224735487140e483188e7cf9e15819e326689d69d7ce80d4981852f3d854ea520d41beeb127970e495681f3ea1de8982069dca0f07f2b90e1ecbf16320ad6088b7ad2959080361a9bfeaeb87989dde3e899cecf7b3626822be3d01c0ffa44825379b79b1077ed86be49bd3fe03eefb2d7327a8a4bee99dd5024732543e698d3d6a31fa86630ec67294b051dd661c8faad090d2a2ae9f2b370bf81145a8c45634d3b6e3b340d3638e5b4f47dc42cc246e57d43e207476905dcea3b0b15a2b1d05867a72627fbc9b7f28dc377deae17c23baaf10c3ae4bc91242c7e26225810429863b2cedb435d911977577b1602aecc56407cf1d7f078614c0bfa000000000000000000000000000000f7edb0f2d5b94371228b3994bed4a29b95000000000000000000000000000000000022935cf13dac2751bdb7aaa8b2d0a50000000000000000000000000000002d3a52edda6e2ef5a34d56c04b11c6ed2b00000000000000000000000000000000002f592db5182d8aed5fc5bd8973f59000000000000000000000000000000019e9c315a7f3805417ef1f14e8e9fbe10400000000000000000000000000000000002148861d053c7198133b3a375d7cf90000000000000000000000000000006984aa09a22a0b8c55d3d699c024cd2e6d000000000000000000000000000000000002775a5bf52be60d925c85ee7e523e000000000000000000000000000000ec0005fa8b559cde662b3f3be1ad27181c00000000000000000000000000000000002a208a2fa0ccaa5526c6578aadb2cf0000000000000000000000000000001b1825521a197af7e57ecd452c8df32ba700000000000000000000000000000000001957337451284d29105082a5a4017d0091ef394c39e5e9860db18934d40734cd053457f7c698364da744909d10abfb000000000000000000000000000000c5a286fef004be8990059fe92606d7b56200000000000000000000000000000000000c04b95c2f48955eedff911cc0eb4b0000000000000000000000000000005904ac67684a50586a5251a4e3396722c800000000000000000000000000000000000af753f8d5557a09c31bd5feb39f0000000000000000000000000000000032c22652253cead79dbef27a158858cfcb00000000000000000000000000000000000fbcb8a5f0aa629e8ef918a04fd4af0000000000000000000000000000009f60d425d7d968ceae19626824745187970000000000000000000000000000000000102074691b9ab7f5026eb35c50100e0000000000000000000000000000004854abc666d9a9eeeaa2d189e6b3e9d9c4000000000000000000000000000000000006d9672c1c3e44ada833914d32b4e6000000000000000000000000000000aa3a513057f54f16e8df05e5bc251a595a0000000000000000000000000000000000305e8c0d2c89ff4ea3e7e0980fbbda000000000000000000000000000000d1840fce956389f7e9494569f0f46da8a200000000000000000000000000000000000fa7c1489076a4b3ac42c586ec9d790000000000000000000000000000000a2cec8ba9a7a85de104830a629cab440d000000000000000000000000000000000000bc97db5496d6eb39117596b98910000000000000000000000000000000b556c4e17bbda3aaec2f192005cc2417510000000000000000000000000000000000192eaf7b603c5073c85a0ce8efbc6000000000000000000000000000000030c9b886295d029311da942e4ee88786c30000000000000000000000000000000000086e5fe49f6ac681d4b2c0ce675aa6000000000000000000000000000000877a72abbf8914013786421d78c3e86d7300000000000000000000000000000000000911ed5ff4df2c4bfb02cbba6628cb000000000000000000000000000000ecfa8a0afc4566a16b39804d6f9f0bebfa00000000000000000000000000000000002fc00d22e6df7d1d75beb47d5d3781000000000000000000000000000000a70a8b496cf956a01cbfdeade55748b9f800000000000000000000000000000000001838756a855e01fa8cacf337a7c84f0000000000000000000000000000005a44895ed19946e3a5e8011128b683cf29000000000000000000000000000000000019264736344944512e33cc78ffdf3d000000000000000000000000000000c2ef7bdfcb013d95f25eb5afc061ea0f6400000000000000000000000000000000001505ae591beb1d8dbe610f9e6af1440000000000000000000000000000009eb3ecbd7122396197f3ce434ba152d4dc0000000000000000000000000000000000096cd1ae04bc5ba06c9f573abc87ad000000000000000000000000000000f3cdc2c5b74f258a9e925d0d307ccc5dbb00000000000000000000000000000000002f06e184132d735f2d68d8bdd4e03a0000000000000000000000000000005f5273d879a6c4abf24a8631289cf74e7400000000000000000000000000000000001a5f1ccd8f0334bcd3cd5d0eb44df5000000000000000000000000000000386812e4e5c4d1a0356a1b1e5b03016e5a00000000000000000000000000000000000ca57698dd5642cb2fae3d133f449a0000000000000000000000000000008807e8908b229d7719a27ed9eb8d34fa1a000000000000000000000000000000000001586bef83d6f0c2c33f0ae122dff3000000000000000000000000000000bcaf32b56664eb9e4e01486e6b394bb2a900000000000000000000000000000000000cd256765f2a80d1b756f6c4ac09d60000000000000000000000000000001aec1468114c2c8ac4fc27ec6dda7522220000000000000000000000000000000000252e05885db162482ae78c4228aecf000000000000000000000000000000f77cdd0e70beb6d741250831e6a0176afa000000000000000000000000000000000008d871e81aafb5db98c2a54ac0654a000000000000000000000000000000001aece28c245b5b4b6768956d5e61d70c00000000000000000000000000000000000672c8b799f30a28b986525218938f000000000000000000000000000000822eebda6a8c07c7f1678717777ec7440700000000000000000000000000000000001761c9f51f297ee2636ca6aa38208f000000000000000000000000000000124c096c513a6b624bc64cb4ebd6c51dee00000000000000000000000000000000001b7e049abb36e886e3afd0f4784fbc00000000000000000000000000000092ff7b4e4a068181b7696d8b1b5a71722100000000000000000000000000000000001b6f42d3b9a7ab399317b81bba8280000000000000000000000000000000dcd02f2374a28481200bd45009af04391b00000000000000000000000000000000002dbf58afb688f18a68f36bd2230e67000000000000000000000000000000f88795f99956fab12e17d05b3d271f2397000000000000000000000000000000000006221d747cd9992d0dbe84b93c5181000000000000000000000000000000d265604897ca1d11506c6714f4043f9f3100000000000000000000000000000000000796bd1dc2c025120016d7e3c7206c0000000000000000000000000000002b84530b5f941bdeb0bad0419ed98097fb000000000000000000000000000000000017daef1e189dc1b291d1e5345405c1000000000000000000000000000000816f36d1eb3c67d0a99cbb812a06a1061d00000000000000000000000000000000000eee61c74ea2ed5d29fe9b5e48a1e40000000000000000000000000000002bd8c1d192477ca6e8615adac7e5c1e4f1000000000000000000000000000000000010234d55a2c8f1b7c3b2583589d9d3000000000000000000000000000000fc0f372218efe6d2f74c9484cec6a8f27400000000000000000000000000000000002d8f9db1d5f7cbdbb84267893c6de50000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000239f24ae82938cb1be3014ceed3210206c70c8adebf3f4229df69e14f37dbee925c446e816769fbd19c4622d2ebe7dcb8149ebdfd61ee6f55be5b9b86b5bf8790bc54278922fa397d1930c2fe9dead95e9d74484da9e20dd11700f4657a968052f9754c81e21d4a58bdfdfbaa268d38547b8d2226005692635d05f71d71808bf2023e14558f9e3376850f0747a31a0923cc494fa2ce3effad6546608e741cba504ac124355d914ab1abfe04c0b644ffdd31cafd40a575b3c387ca1d4cedddbee1ff49291244b52839212b1982a9663d88093bf634b8312480115baf8da8112bc03ef577e3d89418848a9a57644caef143e3aa8bf1601a4a33abeef53f2565bd42aa0e4a0483705869711d13e1ea79388ee99ea24bb0f58cb3ef8b98158e5fd961c1162dba3a2bd8936308219b0781e239841a21b7c88d40dae92962751a3027a2e8750475524f50b0f2597f2608866ff5c7ff29a78b2136e769795fb03fda0830ccc89af43af0e22425880d3b40620d5e10ab6941d15d6977738f92f8c64b30508e50e4fe770169c75ac0869719b65d9da0e84adc3f2c5a79c64ce6f3e2bd34715b4af46d2854a95d4b673ccc23ad2cce5366a5b69fa27958d946ab28f252c7d0b8429fbe47c7773341c14a0e25e9b9ef4db1bfde76bfaf464ea8f45f3821c0700055e61eae0ca674211d8a80bd0bc7928faab5edb76d7d6a3a7297ae22c96570e69b7afd2ddc454ae805268f9846fc8438cea5e046091351e10dead3d9b6d2012b1990ae284d0ae9d3626bbb744bd910e46031c572754edf9f43c53812f5f6600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002f62879de2c4747d904fa2bc2765dff3800a8bb2f9e789b816eae803521de3e51f3b6e99fe00d975d18ece3f29bc24f10dc9887ed99262dcb7016da3c823c1a018d37b16b6b5292c8bc6818cc9414abca756081211ba75e385a82a915506dda60acc48919228a9af6cab7a2530580d0390f49bb3d63da5c62d4c1caae9088c1f00000000000000000000000000000056aeb08ba25b80ba4ed6093ed9a6dfc6d600000000000000000000000000000000000617d0dfb5ce3f0fa0b2c721545cf900000000000000000000000000000036b8f8007db5d54cea40627e20116063c000000000000000000000000000000000001fd652927961c80648ee1bb81f3f1500000000000000000000000000000082d558962bb328a2563b069d11ded84210000000000000000000000000000000000005bca986bc368bfd84c446fa0c56230000000000000000000000000000000ce1551739ce792e4261e814c0a5f8b4ed000000000000000000000000000000000008774488054541477e0882cdd44fd2"

        // ダミーのNextCmtとNextCmtR
        val dummyNextCmt = "0x1111111111111111111111111111111111111111111111111111111111111111"
        val dummyNextCmtR = "0x2222222222222222222222222222222222222222222222222222222222222222"

        // ProofResultオブジェクトを作成
        val proofResult = ProofResult(
            proof = dummyProof,
            nextCmt = dummyNextCmt,
            nextCmtR = dummyNextCmtR
        )

        try {
            // convertProofForInfura関数をテスト
            val result = proofResult.convertProofForInfura()

            // 基本的な検証
            assertNotNull(result, "Result should not be null")
            assertTrue(result.startsWith("0x"), "Result should start with 0x")

            // MethodIDの確認
            assertTrue(result.startsWith("0xea50d0e4"), "Result should start with MethodID 0xea50d0e4")

            // 結果の詳細を出力
            println("ConvertProofForInfura テスト成功")
            println("Input proof length: ${dummyProof.length}")
            println("Output data length: ${result.length}")
            println("Output data (first 100 chars): ${result.take(100)}")

            // データ構造の確認
            val withoutPrefix = result.substring(2) // 0xを除去

            // MethodID (8文字)
            val methodId = withoutPrefix.substring(0, 8)
            assertEquals("ea50d0e4", methodId, "MethodID should be ea50d0e4")

            // proofのオフセット (64文字)
            val proofOffset = withoutPrefix.substring(8, 72)
            assertEquals("0000000000000000000000000000000000000000000000000000000000000040", proofOffset, "Proof offset should be 0x40")

            println("データ構造の検証完了: MethodIDとproofオフセットが正しく設定されています")

        } catch (e: Exception) {
            println("convertProofForInfuraテスト中にエラーが発生しました: ${e.message}")
            e.printStackTrace()
            throw e
        }
    }

    /**
     * PEM形式の証明書文字列をCertificateオブジェクトに変換するヘルパー関数
     */
    private fun parsePemCertificate(pemData: String): Certificate {
        val certData = pemData
            .replace("-----BEGIN CERTIFICATE-----", "")
            .replace("-----END CERTIFICATE-----", "")
            .replace("\\s+".toRegex(), "")

        val certBytes = Base64.getDecoder().decode(certData)
        val certFactory = CertificateFactory.getInstance("X.509")

        return certFactory.generateCertificate(ByteArrayInputStream(certBytes))
    }
}